<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Vérification Chaotique</title>
<style>
    body {
        margin: 0;
        height: 100vh;
        background: #0b0b0b;
        color: #e6e6e6;
        font-family: monospace;
        display: flex;
        justify-content: center;
        align-items: center;
    }

    .box {
        width: 360px;
        border: 1px solid #444;
        padding: 25px;
        background: #111;
        box-shadow: 0 0 25px rgba(255,0,0,0.15);
        text-align: center;
    }

    button, input[type=range] {
        margin-top: 15px;
        padding: 8px 15px;
        background: none;
        border: 1px solid #666;
        color: #ccc;
        cursor: pointer;
    }

    button:hover {
        color: white;
        border-color: white;
    }

    #task {
        min-height: 70px;
    }

    .hidden {
        display: none;
    }
</style>
</head>
<body>

<div class="box">
    <div id="task">Chargement du test…</div>
    <div id="actions"></div>
</div>

<script>
let step = 0;
const totalSteps = Math.floor(Math.random() * 3) + 3;

startCaptcha();

function startCaptcha() {
    nextTask();
}

function nextTask() {
    step++;
    document.getElementById("actions").innerHTML = "";

    if (step > totalSteps) {
        document.getElementById("task").innerHTML = "✔ Vérification terminée.<br>Tu es probablement humain.";
        document.getElementById("task").style.color = "#7CFF9B";
        return;
    }

    const tasks = [waitTask, wrongButtonTask, sliderTask, paradoxTask];
    const task = tasks[Math.floor(Math.random() * tasks.length)];
    task();
}

/* MINI CAPTCHA 1 — ATTENDRE */
function waitTask() {
    const time = Math.floor(Math.random() * 4) + 3;
    document.getElementById("task").textContent = `Attends ${time} secondes sans cliquer.`;
    setTimeout(nextTask, time * 1000);
}

/* MINI CAPTCHA 2 — CLIQUER LE MAUVAIS BOUTON */
function wrongButtonTask() {
    document.getElementById("task").textContent = "Clique le bouton qui ne sert à rien.";

    const a = document.createElement("button");
    const b = document.createElement("button");

    a.textContent = "Continuer";
    b.textContent = "Ne pas cliquer";

    a.onclick = () => location.reload();
    b.onclick = nextTask;

    document.getElementById("actions").append(a, b);
}

/* MINI CAPTCHA 3 — SLIDER IMPRÉCIS */
function sliderTask() {
    document.getElementById("task").textContent = "Place le curseur dans une zone moche.";

    const range = document.createElement("input");
    range.type = "range";
    range.min = 0;
    range.max = 100;

    range.onchange = () => {
        if (range.value > 42 && range.value < 58) {
            nextTask();
        } else {
            location.reload();
        }
    };

    document.getElementById("actions").appendChild(range);
}

/* MINI CAPTCHA 4 — PARADOXE */
function paradoxTask() {
    document.getElementById("task").textContent = "Clique quand tu penses que c’est le mauvais moment.";

    const btn = document.createElement("button");
    btn.textContent = "Maintenant ?";

    const delay = Math.random() * 4000 + 2000;
    let allowed = false;

    setTimeout(() => allowed = true, delay);

    btn.onclick = () => {
        if (allowed) nextTask();
        else location.reload();
    };

    document.getElementById("actions").appendChild(btn);
}
</script>

</body>
</html>
